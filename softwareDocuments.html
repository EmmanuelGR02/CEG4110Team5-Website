<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <link rel="stylesheet" href="style/homepage.css"/>
    <link rel="stylesheet" href="style/softwareDocuments.css"/>
    <title>Software Documents</title>
  </head>
  <body>
    <!-- Display the header on top of the page -->
    <header></header>
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        // Fetch and insert header
        fetch('header.html')
          .then(r => r.text())
          .then(html => {
            document.querySelector('header').innerHTML = html;
          });

        // ====== Test Plan iframe injection ======
        const iframe = document.getElementById('test-plan-iframe');
        if (iframe) {
          // path must match your Netlify deploy (case-sensitive!)
          const filePath = '/softwaredocuments/master chef - test plan spreadsheet.xlsx';
          const fullUrl  = window.location.origin + filePath;
          // encode the full URL for Office embed
          const encoded  = encodeURIComponent(fullUrl);
          iframe.src     = `https://view.officeapps.live.com/op/embed.aspx?src=${encoded}`;
        }
      });
    </script>

    <h1>Software Documents</h1>
    <h4>
      Includes documentation associated with our project, including
      presentations, the Software Requirements Specification (SRS) Document,
      as well as Test Plan sheet.
    </h4>

    <div class="document-wrapper">
      <div class="documents">
        <h3>Requirements Presentation</h3>
        <div class="pdf_preview">
          <iframe
            src="SoftwareDocuments/Master Chef - Requirements Presentation.pdf"
            frameborder="0">
          </iframe>
        </div>
        <a href="SoftwareDocuments/Master Chef - Requirements Presentation.pdf" target="_blank">
          View Full Presentation
        </a>
      </div>

      <div class="documents">
        <h3>Software Requirement Specification Document</h3>
        <div class="pdf_preview">
          <iframe
            src="SoftwareDocuments/Master Chef - Software Requirements Specification.pdf"
            frameborder="0">
          </iframe>
        </div>
        <a href="SoftwareDocuments/Master Chef - Software Requirements Specification.pdf" target="_blank">
          View Full Document
        </a>
      </div>

      <div class="documents">
        <h3>Software Test Plan</h3>
        <div class="excel_preview">
          <!-- leave src empty; JS will populate it on load -->
          <iframe
            id="test-plan-iframe"
            width="100%" height="600"
            frameborder="0">
          </iframe>
        </div>
        <a
          href="/softwaredocuments/master%20chef%20-%20test%20plan%20spreadsheet.xlsx"
          target="_blank">
          Download Test Plan (.xlsx)
        </a>
      </div>
    </div>
  </body>
</html>
